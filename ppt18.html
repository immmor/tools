<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>immmor code: 技术演进报告</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/reveal.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/theme/blood.min.css">
    <style>
        :root {
            --clay-bg: #f0f4f8;
            --clay-accent: #ffb000; /* 沿用琥珀色 */
            --clay-shadow: rgba(167, 185, 203, 0.4);
        }
        body { background: var(--clay-bg) !important; color: #4a5568 !important; }
        #canvas-blob { position: fixed; top: 0; left: 0; z-index: 0; pointer-events: none; }
        .reveal { z-index: 1; }

        /* 粘土拟物化卡片 */
        .clay-card {
            background: #ffffff !important;
            border-radius: 40px !important;
            box-shadow: 
                20px 20px 60px var(--clay-shadow),
                -20px -20px 60px #ffffff !important;
            padding: 50px !important;
            border: none !important;
            text-align: left !important;
        }

        h2 {
            color: #2d3748 !important;
            font-weight: 800 !important;
            text-shadow: none !important;
            margin-bottom: 30px !important;
        }

        .highlight-bar {
            height: 8px; width: 60px;
            background: var(--clay-accent);
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .reveal .slides section { color: #4a5568 !important; }
        .feature-item {
            background: #f7fafc;
            border-radius: 20px;
            padding: 15px 25px;
            margin-bottom: 15px;
            box-shadow: inset 4px 4px 8px var(--clay-shadow), inset -4px -4px 8px #fff;
        }
    </style>
</head>
<body>

    <canvas id="canvas-blob"></canvas>

    <div class="reveal">
        <div class="slides">

            <section>
                <div class="clay-card">
                    <div class="highlight-bar"></div>
                    <h2>IMMMOR CODE</h2>
                    <p style="font-size: 1.2em; opacity: 0.8;">全能型 Web 代码实验室</p>
                    <p><small>底层功能架构与技术实现细节</small></p>
                </div>
            </section>

            <section>
                <div class="clay-card">
                    <h2>01. 混合运行矩阵</h2>
                    <p>源码通过 <code>Pyodide</code> 实现了多种执行策略：</p>
                    <div class="feature-item fragment">
                        <strong>标准模式：</strong> 直接在 Web Worker 中执行 Python 脚本，获取纯净输出。
                    </div>
                    <div class="feature-item fragment">
                        <strong>交互式模式：</strong> 终端（Terminal）实时同步执行结果，支持 <code>stdout</code> 重定向。
                    </div>
                    
                </div>
            </section>

            <section>
                <div class="clay-card">
                    <h2>02. AI 上下文管理器</h2>
                    <p>针对浏览器内存限制，immmor 优化了 AI 请求：</p>
                    <ul>
                        <li class="fragment"><strong>按需注入：</strong> 源码函数自动提取当前 <code>activeFile</code> 的相关内容。</li>
                        <li class="fragment"><strong>全局规则同步：</strong> 自动读取项目根目录的 <code>PROTOCOL.txt</code> 作为指令底色。</li>
                        <li class="fragment"><strong>流式解析：</strong> 采用分块读取 AI 回复，降低长时间阻塞感。</li>
                    </ul>
                </div>
            </section>

            <section>
                <div class="clay-card">
                    <h2>03. 零摩擦资产导入</h2>
                    <p><code>editor.html</code> 深度集成了浏览器拖拽协议：</p>
                    <div class="feature-item fragment">
                        <strong>ZIP 热识别：</strong> 拖入压缩包后，后台异步调用 <code>JSZip</code> 扫描目录结构。
                    </div>
                    <div class="feature-item fragment">
                        <strong>虚拟磁盘挂载：</strong> 无需通过服务器中转，直接映射到 IndexedDB 的存储簇中。
                    </div>
                    
                </div>
            </section>

            <section>
                <div class="clay-card">
                    <h2>04. 全局状态同步锁</h2>
                    <p>源码通过 <code>localStorage</code> 记录了一套复杂的 UI 状态：</p>
                    <ul>
                        <li><strong>页签顺序记录：</strong> <code>ind_console_tabs</code> 数组确保重启后排版一致。</li>
                        <li><strong>主题偏好：</strong> 即使在离线状态下也能瞬间加载个性化琥珀色配置。</li>
                        <li><strong>错误回溯：</strong> 自动记录上一次 Python 运行时的崩溃堆栈信息。</li>
                    </ul>
                </div>
            </section>

            <section>
                <div class="clay-card" style="text-align: center !important;">
                    <h2 style="color: var(--clay-accent) !important;">让代码触手可及</h2>
                    <p>immmor code: 重塑 Web 端 IDE 体验</p>
                </div>
            </section>

        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/4.5.0/reveal.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        Reveal.initialize({ center: true, hash: true, transition: 'convex' });

        // Three.js 动态软体 Blob
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('canvas-blob'), antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);

        const geo = new THREE.SphereGeometry(2, 64, 64);
        const mat = new THREE.MeshNormalMaterial({ wireframe: false, opacity: 0.1, transparent: true });
        const blob = new THREE.Mesh(geo, mat);
        scene.add(blob);

        camera.position.z = 5;

        function animate() {
            requestAnimationFrame(animate);
            const time = Date.now() * 0.001;
            const positions = geo.attributes.position.array;
            for(let i=0; i<positions.length; i+=3) {
                const x = positions[i];
                const y = positions[i+1];
                const z = positions[i+2];
                const offset = (Math.sin(x*2 + time) + Math.cos(y*2 + time)) * 0.1;
                // 这里仅做演示，真实软体需更复杂逻辑
            }
            blob.rotation.y += 0.005;
            blob.rotation.x += 0.003;
            renderer.render(scene, camera);
        }
        animate();
    </script>
</body>
</html>