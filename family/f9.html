<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>家族宗谱·典藏版</title>
    <style>
        :root {
            --stone-bg: #e5e5e0; 
            --ink: #1a1a1a;
            --bronze: #8c6d46; 
            --border-heavy: #2c2c2c;
            --paper: #f9f7f2;
            --highlight: #c0392b;
        }

        body {
            background-color: #d6d6d0;
            background-image: url("https://www.transparenttextures.com/patterns/natural-paper.png");
            margin: 0;
            padding: 20px 10px 60px 10px;
            font-family: "Noto Serif SC", "Source Han Serif SC", "SimSun", serif;
            color: var(--ink);
        }

        .ancestral-shrine {
            max-width: 700px;
            margin: 0 auto;
            border: 6px double var(--border-heavy);
            padding: 40px 20px;
            background: var(--stone-bg);
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            position: relative;
        }

        /* 搜索区域 */
        .search-container {
            margin-bottom: 30px;
            text-align: center;
            position: relative;
            z-index: 20;
        }

        .search-input {
            background: var(--paper);
            border: 1px solid var(--bronze);
            padding: 8px 15px;
            width: 60%;
            font-family: inherit;
            outline: none;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
        }

        .search-input:focus {
            box-shadow: 0 0 5px var(--bronze);
        }

        /* 碑首 */
        .shrine-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--bronze);
            padding-bottom: 20px;
        }

        .shrine-header h1 {
            font-size: 56px;
            letter-spacing: 15px;
            margin: 0;
            font-weight: 900;
        }

        .family-stats {
            font-size: 12px;
            color: var(--bronze);
            margin-top: 10px;
            letter-spacing: 2px;
        }

        /* 树状结构 */
        #genealogy-tree {
            padding-left: 0;
        }

        ul {
            list-style: none;
            padding-left: 35px;
            margin: 0;
            position: relative;
        }

        li {
            position: relative;
            padding: 12px 0;
        }

        li::before {
            content: "";
            position: absolute;
            left: -18px;
            top: 0;
            bottom: 0;
            width: 1px;
            background: var(--bronze);
        }

        li:last-child::before { height: 35px; }

        /* 节点样式 */
        .tablet-node {
            background: var(--paper);
            border: 1px solid #d1d1c1;
            border-left: 6px solid var(--border-heavy);
            padding: 12px;
            box-shadow: 3px 3px 10px rgba(0,0,0,0.05);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            position: relative;
        }

        .tablet-node:hover {
            transform: translateX(8px);
            border-color: var(--bronze);
            background: #fff;
        }

        /* 搜索命中样式 */
        .search-match {
            border-left-color: var(--highlight) !important;
            background: #fff8f8 !important;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(192, 57, 43, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(192, 57, 43, 0); }
            100% { box-shadow: 0 0 0 0 rgba(192, 57, 43, 0); }
        }

        /* 头像样式 */
        .avatar-box {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 2px solid var(--bronze);
            margin-right: 15px;
            overflow: hidden;
            background: #eee;
            flex-shrink: 0;
        }

        .avatar-box img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            filter: sepia(0.5); /* 统一古风色调 */
        }

        .name-area {
            flex: 1;
        }

        .full-name {
            font-size: 18px;
            font-weight: bold;
            color: #000;
            display: block;
        }

        .life-info {
            font-size: 12px;
            color: #666;
            margin-top: 4px;
            display: block;
        }

        .rank-label {
            writing-mode: vertical-rl;
            text-orientation: upright;
            font-size: 11px;
            color: var(--bronze);
            border-left: 1px solid #ddd;
            padding-right: 8px;
            padding-left: 3px;
            margin-left: 10px;
            letter-spacing: 0;
            line-height: 1.2;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        /* 交互状态 */
        .toggle-icon {
            width: 20px;
            font-size: 12px;
            color: var(--bronze);
            cursor: pointer;
        }

        .expanded > .sub-descendants {
            display: block;
        }

        .sub-descendants {
            display: none;
        }

        /* 装饰 */
        .corner {
            position: absolute;
            width: 30px;
            height: 30px;
            border: 3px solid var(--bronze);
            z-index: 10;
            pointer-events: none;
        }
        .tl { top: 10px; left: 10px; border-right: none; border-bottom: none; }
        .tr { top: 10px; right: 10px; border-left: none; border-bottom: none; }
        .bl { bottom: 10px; left: 10px; border-right: none; border-top: none; }
        .br { bottom: 10px; right: 10px; border-left: none; border-top: none; }

    </style>
</head>
<body>

<div class="ancestral-shrine">
    <div class="corner tl"></div>
    <div class="corner tr"></div>
    <div class="corner bl"></div>
    <div class="corner br"></div>

    

    <div class="shrine-header">
        <h1>王氏族譜</h1>
        <div id="stats" class="family-stats">—— 溯本求源 · 绵延不绝 ——</div>
    </div>

    <div class="search-container">
        <input type="text" id="memberSearch" class="search-input" placeholder="输入姓名搜索族人...">
    </div>

    <div id="tree-container">
        <ul id="genealogy-tree"></ul>
    </div>
</div>

<script>
    /**
     * 家族数据配置
     * avatar: 图片路径，留空则显示默认
     */
    const familyData = [
        {
            name: "王公諱世傑",
            meta: "第一世 · 始遷祖 · 配李氏",
            rank: "正本清源",
            avatar: "https://api.dicebear.com/7.x/bottts/svg?seed=ancestor1", // 示例头像
            children: [
                {
                    name: "王公諱繼先",
                    meta: "第二世 · 長房 · 宣德年间生",
                    rank: "枝繁葉茂",
                    avatar: "",
                    children: [
                        {
                            name: "王公諱紹寬",
                            meta: "第三世 · 庠生 · 承嗣",
                            rank: "克紹箕裘",
                            avatar: "",
                            children: []
                        },
                        {
                            name: "王公諱紹敏",
                            meta: "第三世 · 居城南",
                            rank: "兰馨桂馥",
                            avatar: "",
                            children: []
                        }
                    ]
                },
                {
                    name: "王公諱繼德",
                    meta: "第二世 · 次房 · 居永安",
                    rank: "德厚流光",
                    avatar: "",
                    children: [
                        {
                            name: "王公諱紹严",
                            meta: "第三世 · 岁贡生",
                            rank: "光宗耀祖",
                            avatar: "",
                            children: []
                        }
                    ]
                }
            ]
        }
    ];

    let memberCount = 0;
    const defaultAvatar = "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZmlsbD0iI2NjYyIgZD0iTTEyIDJDNi40OCAyIDIgNi40OCAyIDEyczQuNDggMTAgMTAgMTAgMTAtNC40OCAxMC0xMFMxNy41MiAyIDEyIDJ6bTAgM2MyLjIxIDAgNCAxLjc5IDQgNHMtMS43OSA0LTQgNC00LTEuNzktNC00IDEuNzktNCA0LTR6bTAgMTMuOTFjLTIuNTEgMC00LjczLTEuMjgtNS44Ni0zLjI0LjA4LTEuOTQgMy45OC0zIDUuODYtMyA0LjgyIDAgOC43OSAxLjA2IDguODYgM3YtLjA2Yy0xLjEzIDEuOTYtMy4zNSAzLjI0LTUuODYgMy4yNHoiLz48L3N2Zz4=";

    // 递归渲染树
    function renderTree(data, container) {
        data.forEach(person => {
            memberCount++;
            const li = document.createElement('li');
            const hasChildren = person.children && person.children.length > 0;
            
            li.className = hasChildren ? 'item has-children expanded' : 'item';
            
            li.innerHTML = `
                <div class="tablet-node" data-name="${person.name}">
                    <div class="toggle-icon">${hasChildren ? '▼' : ''}</div>
                    <div class="avatar-box">
                        <img src="${person.avatar || defaultAvatar}" alt="头像">
                    </div>
                    <div class="name-area">
                        <span class="full-name">${person.name}</span>
                        <span class="life-info">${person.meta}</span>
                    </div>
                    <div class="rank-label">${person.rank}</div>
                </div>
                ${hasChildren ? '<ul class="sub-descendants"></ul>' : ''}
            `;

            // 绑定点击事件（折叠/展开）
            li.querySelector('.tablet-node').addEventListener('click', function(e) {
                if (hasChildren) {
                    li.classList.toggle('expanded');
                    this.querySelector('.toggle-icon').innerText = li.classList.contains('expanded') ? '▼' : '▶';
                }
            });

            if (hasChildren) {
                renderTree(person.children, li.querySelector('.sub-descendants'));
            }
            
            container.appendChild(li);
        });
    }

    // 搜索功能
    document.getElementById('memberSearch').addEventListener('input', function(e) {
        const keyword = e.target.value.trim();
        const allNodes = document.querySelectorAll('.tablet-node');
        
        allNodes.forEach(node => {
            const name = node.getAttribute('data-name');
            if (keyword && name.includes(keyword)) {
                node.classList.add('search-match');
                // 自动展开父级
                expandParents(node);
            } else {
                node.classList.remove('search-match');
            }
        });
    });

    // 递归展开所有父节点
    function expandParents(node) {
        let parent = node.parentElement.closest('.item');
        while (parent) {
            parent.classList.add('expanded');
            const icon = parent.querySelector('.toggle-icon');
            if(icon) icon.innerText = '▼';
            parent = parent.parentElement.closest('.item');
        }
    }

    // 初始化渲染
    const treeRoot = document.getElementById('genealogy-tree');
    renderTree(familyData, treeRoot);
    
    // 更新统计
    document.getElementById('stats').innerText = `共载录家族成员：${memberCount} 位 · 慎終追遠`;

</script>

</body>
</html>