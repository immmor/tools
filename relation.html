<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>immmor Kinship | 亲戚关系计算器</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/relationship.js/dist/relationship.min.js"></script>
    <style>
        body {
            background: radial-gradient(circle at top right, #1e293b, #0f172a, #000000);
            min-height: 100vh;
            color: white;
        }
        .glass {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .gradient-text {
            background: linear-gradient(90deg, #60a5fa, #a78bfa, #f472b6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .btn-kin {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.2s;
        }
        .btn-kin:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.3);
            transform: scale(0.98);
        }
        .btn-op {
            background: rgba(96, 165, 250, 0.2);
            color: #60a5fa;
            border: 1px solid rgba(96, 165, 250, 0.3);
        }
    </style>
</head>
<body class="p-4 md:p-8 flex flex-col items-center">

    <nav class="w-full max-w-md mb-8">
        <div class="text-2xl font-bold tracking-tighter gradient-text">immmor.KIN</div>
        <div class="text-gray-500 text-[10px] uppercase tracking-widest mt-1">亲戚关系计算器</div>
    </nav>

    <main class="w-full max-w-md space-y-4">
        
        <section class="glass p-6 rounded-3xl min-h-[160px] flex flex-col justify-end text-right">
            <div id="chain" class="text-gray-400 text-sm mb-2 break-all h-6 overflow-hidden">我</div>
            <div id="result" class="text-3xl font-bold gradient-text break-words">自己</div>
        </section>

        <div class="flex space-x-2">
            <button onclick="setSex(1)" id="sex-m" class="flex-1 py-2 rounded-xl glass text-xs border-blue-500/50 bg-blue-500/10">男</button>
            <button onclick="setSex(0)" id="sex-f" class="flex-1 py-2 rounded-xl glass text-xs opacity-50">女</button>
        </div>

        <section class="grid grid-cols-4 gap-2">
            <button class="btn-kin p-4 rounded-xl text-sm" onclick="add('父')">父</button>
            <button class="btn-kin p-4 rounded-xl text-sm" onclick="add('母')">母</button>
            <button class="btn-kin p-4 rounded-xl text-sm btn-op" onclick="backspace()">←</button>
            <button class="btn-kin p-4 rounded-xl text-sm btn-op" onclick="clearAll()">C</button>
            
            <button class="btn-kin p-4 rounded-xl text-sm" onclick="add('夫')">夫</button>
            <button class="btn-kin p-4 rounded-xl text-sm" onclick="add('妻')">妻</button>
            <button class="btn-kin p-4 rounded-xl text-sm" onclick="add('兄')">兄</button>
            <button class="btn-kin p-4 rounded-xl text-sm" onclick="add('弟')">弟</button>
            
            <button class="btn-kin p-4 rounded-xl text-sm" onclick="add('姐')">姐</button>
            <button class="btn-kin p-4 rounded-xl text-sm" onclick="add('妹')">妹</button>
            <button class="btn-kin p-4 rounded-xl text-sm" onclick="add('子')">子</button>
            <button class="btn-kin p-4 rounded-xl text-sm" onclick="add('女')">女</button>

            <button class="btn-kin p-4 rounded-xl text-xs col-span-2 btn-op" onclick="reverse()">我在对方眼里叫什么？</button>
            <button class="btn-kin p-4 rounded-xl text-sm col-span-2 bg-blue-600 !text-white" onclick="calc()">计算</button>
        </section>

        <p class="text-[10px] text-gray-600 text-center uppercase tracking-tighter">
            算法支持多重嵌套，如“爸爸的爸爸的弟弟的儿子”
        </p>
    </main>

    <script>
        let sex = 1; // 1为男，0为女
        let inputChain = []; // 存储关系链

        const chainDisplay = document.getElementById('chain');
        const resultDisplay = document.getElementById('result');

        function setSex(s) {
            sex = s;
            document.getElementById('sex-m').classList.toggle('bg-blue-500/10', s === 1);
            document.getElementById('sex-m').classList.toggle('border-blue-500/50', s === 1);
            document.getElementById('sex-m').classList.toggle('opacity-50', s === 0);
            
            document.getElementById('sex-f').classList.toggle('bg-blue-500/10', s === 0);
            document.getElementById('sex-f').classList.toggle('border-blue-500/50', s === 0);
            document.getElementById('sex-f').classList.toggle('opacity-50', s === 1);
            calc();
        }

        function add(relation) {
            inputChain.push(relation);
            updateUI();
            calc();
        }

        function backspace() {
            inputChain.pop();
            updateUI();
            calc();
        }

        function clearAll() {
            inputChain = [];
            updateUI();
            resultDisplay.innerText = "自己";
        }

        function updateUI() {
            chainDisplay.innerText = inputChain.length > 0 ? '我的' + inputChain.join('的') : '我';
        }

        function calc() {
            if (inputChain.length === 0) {
                resultDisplay.innerText = "自己";
                return;
            }
            const text = '我的' + inputChain.join('的');
            const res = relationship({ text: text, sex: sex });
            
            if (res.length > 0) {
                resultDisplay.innerText = res[0];
            } else {
                resultDisplay.innerText = "关系太远啦";
            }
        }

        function reverse() {
            if (inputChain.length === 0) return;
            const text = '我的' + inputChain.join('的');
            const res = relationship({ text: text, sex: sex, reverse: true });
            if (res.length > 0) {
                resultDisplay.innerText = "对方称呼我为：" + res[0];
            }
        }
    </script>
</body>
</html>